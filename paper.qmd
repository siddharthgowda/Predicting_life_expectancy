---
title: "Prediction Developing Countries' Life Expectancy"
author: 
  - Siddharth Gowda
  - Syed Hasan
  - Arshh Relan
date: today
date-format: long
format: pdf
number-sections: true
toc: true
---

# Contributions

\newpage

# Introduction

Life expectancy is a fundamental indicator of a country's overall health and development. It reflects the effectiveness of healthcare systems, economic stability, and social progress. In developing countries healthcare resources are often constrained and economic disparities persist. Here, understanding the factors that influence life expectancy is critical for shaping effective policies. This study aims to answer the question: How economic, health and social factors influence life expectancy in developing countries, collectively and individually?
A multiple linear regression model is used, incorporating GDP per capita, alcohol consumption (categorical variable), schooling, infant mortality, health expenditure, and HIV prevalence as explanatory variables. Existing literature provides strong evidence supporting the relationship between these factors and life expectancy. Miladinov (2020) examined the link between socioeconomic development and life expectancy in EU accession candidate countries, finding that higher GDP per capita and lower infant mortality rates were associated with increased life expectancy, he also suggests lower alcohol consumption. Our study focuses on developing nations facing similar economic and healthcare challenges.  
Adebayo et al. (2024) analyzed data in the United States, finding higher health expenditure and GDP per capita positively impact life expectancy while higher infant mortality reduces it. Our study extends this analysis to developing countries, allowing us to compare how these determinants function in different economic contexts. Our study provides a broader perspective on additional health risks that impact life expectancy in low-income nations.
A third study on OECD countries (Roffia et al., 2022) found that education and economic conditions played a critical role in increasing life expectancy. This supports our inclusion of schooling as a key predictor, as education directly influences health outcomes and economic mobility.  
To analyze these relationships, our study employs multiple linear regression. This is well-suited for our study because it allows us to analyze the relationship between life expectancy and multiple predictor variables simultaneously. Life expectancy is influenced by a combination of factors, making a univariate approach insufficient for capturing the complexity. This enables us to quantify the individual impact of each variable while controlling for the others. This study seeks to generate actionable insights for policymakers to improve life expectancy in developing nations.

\newpage


```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(knitr)
library(janitor)
library(ggplot2)
```

# Data Description

```{r}
#| include: false
#| warning: false
#| message: false

raw_data = read_csv("./Life_Expectancy_Data.csv")
clean_data = raw_data %>% clean_names() %>% drop_na()

```

```{r}
#| include: false
#| warning: false
#| message: false
data_interest = clean_data %>% filter(status == "Developing") %>% rename(gdp_capita = gdp) %>% select(life_expectancy, infant_deaths, hiv_aids, gdp_capita, schooling, percentage_expenditure, alcohol)
data_interest <- data_interest %>% 
  mutate(alcohol = case_when(alcohol <= 1.08 ~ "Negligible", 
                             TRUE ~ "Consumed"))

```

## Response Variable

```{r}
#| label: fig-hislfe
#| echo: false
#| warning: false
life_expectancy_stats <- data_interest %>%
  summarise(
    Mean = mean(life_expectancy, na.rm = TRUE),
    Median = median(life_expectancy, na.rm = TRUE),
    Std_Dev = sd(life_expectancy, na.rm = TRUE),
    Min = min(life_expectancy, na.rm = TRUE),
    Max = max(life_expectancy, na.rm = TRUE)
  )


ggplot(data_interest, aes(x = life_expectancy)) +
  geom_histogram(binwidth = 4, fill = "skyblue", color = "black") +
  theme_minimal() +
  labs(title = "Histogram of Life Expectancy", x = "Life Expectancy", y = "Countries")

# kable(life_expectancy_stats, caption = "Basic Statistics for Life Expectancy")
```

\newpage

## Predictor Variables

```{r}
#| label: fig-predvars
#| layout-ncol: 3
#| layout-nrow: 2
#| fig-cap: ""
#| fig-subcap: ["", "", "", "", "", ""]
#| fig-align: "center"
#| echo: false
#| warning: false
#| message: false
#| fig.show: "hold"

ggplot(data_interest, aes(x = hiv_aids)) +
  geom_histogram(binwidth = 2, fill = "skyblue", color = "black") +
  theme_minimal() +
  labs(title = "Histogram of HIV/AIDS", x = "HIV/AIDS Deaths per 1000 live births", y = "Countries")

ggplot(data_interest, aes(x = gdp_capita)) +
  geom_histogram(binwidth = 2500, fill = "lightgreen", color = "black") +
  theme_minimal() +
  labs(title = "Histogram of GDP per Capita", x = "GDP per Capita", y = "Countries")

ggplot(data_interest, aes(x = infant_deaths)) +
  geom_histogram(binwidth = 50, fill = "lightcoral", color = "black") +
  theme_minimal() +
  labs(title = "Histogram of Infant Deaths", x = "Infant Deaths per 1000 People", y = "Countries")

ggplot(data_interest, aes(x = percentage_expenditure)) +
  geom_histogram(binwidth = 250, fill = "lightblue", color = "black") +
  theme_minimal() +
  labs(title = "Histogram of Health Expenditure", x = "Health Expenditure (as a percentage of GDP per capita)", y = "Countries")

ggplot(data_interest, aes(x = schooling)) +
  geom_histogram(binwidth = 1, fill = "lightgoldenrod", color = "black") +
  theme_minimal() +
  labs(title = "Histogram of Schooling", x = "Average Number of years of Schooling", y = "Countries")

ggplot(data_interest, aes(x = alcohol, fill = alcohol)) +
  geom_bar(color = "black") +
  theme_minimal() +
  labs(title = "Number of Countries that Consume Alcohol", 
       x = "Alcohol Category", y = "Number of Countries") +
  scale_fill_manual(values = c("Negligible" = "skyblue", "Consumed" = "salmon"))


```

\newpage

# Preliminary Results

```{r}
#| label: tbl-modelresults
#| warning: false
#| message: false
#| echo: false
preliminary_model = lm(life_expectancy ~ infant_deaths + hiv_aids + gdp_capita + 
                         schooling + percentage_expenditure + alcohol, 
                       data=data_interest)

#summary(preliminary_model)

model_table <- data.frame(
  Variable = c("(Intercept)", "Infant Deaths", "HIV/AIDS", "GDP per Capita", 
               "Schooling", "Percentage Expenditure", "Alcohol (Negligible)"),
  Estimate = c(49.50, -0.002131, -0.6713, 7.542e-06, 1.701, 0.00109, -0.670),
  Std_Error = c(0.7476, 0.0009369, 0.01917, 5.514e-05, 0.06129, 0.0003605, 0.2859),
  T_Value = c(66.216, -2.274, -35.018, 0.137, 27.757, 3.025, -2.343),
  P_Value = c("< 2e-16", "0.02309", "< 2e-16", "0.89121", "< 2e-16", "0.00253", "0.01924")
)

# Generate a nicely formatted table
kable(model_table, digits = 4, align = "c",
      col.names = c("Variable", "Estimate", "Std. Error", "t Value", "Pr(>|t|)"))

```

## Confouding Plots

```{r}
#| label: fig-confoundingplots
#| layout-ncol: 2
#| fig-cap: ""
#| fig-subcap: ["", ""]
#| fig-align: "center"
#| warning: false
#| message: false
#| echo: false
#| fig.show: "hold"

ggplot(data_interest, aes(x = percentage_expenditure, y = gdp_capita)) +
  geom_point(alpha = 0.6) +
  geom_smooth() +
  theme_minimal() +
  labs(title = "Health Expenditure can Predict GDP Per Capita",
       x = "Health Expenditure (as a percentage of GDP per capita)", 
       y = "GDP per Capita")

ggplot(data_interest, aes(x = percentage_expenditure, fill = alcohol)) +
  geom_histogram(binwidth = 250, color = "black", alpha = 0.6, position = "identity") +
  theme_minimal() +
  labs(title = "Countries that Consume Alcohol Spend More on Health",
       x = "Health Expenditure (as a percentage of GDP per capita)",
       y = "Count",
       fill = "Alcohol Consumption") +
  scale_fill_manual(values = c("Negligible" = "skyblue", "Consumed" = "salmon"))


```


## Residual Plots

```{r}
#| label: fig-resplots
#| layout-ncol: 3
#| fig-cap: ""
#| fig-subcap: ["", "", ""]
#| fig-align: "center"
#| echo: false
#| warning: false
#| message: false
#| fig.show: "hold"

plot(preliminary_model, which = 1)
plot(preliminary_model, which = 2)
standard_residuals = rstandard(preliminary_model)
plot(data_interest$schooling, standard_residuals, main="Standardized Residuals V. Schooling", 
     xlab="Average Years in School", ylab="Standardized Residuals")

```
